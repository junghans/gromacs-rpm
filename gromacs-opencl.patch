diff -up gromacs-5.1/cmake/gmxManageOpenCL.cmake.opencl gromacs-5.1/cmake/gmxManageOpenCL.cmake
--- gromacs-5.1/cmake/gmxManageOpenCL.cmake.opencl	2015-08-13 13:48:09.000000000 +0200
+++ gromacs-5.1/cmake/gmxManageOpenCL.cmake	2015-09-23 22:06:39.853725998 +0200
@@ -59,7 +59,7 @@ endif()
 
 # Yes Virginia, Darwin kernel version 14.4 corresponds to OS X 10.4.
 if(APPLE AND ${CMAKE_SYSTEM_VERSION} VERSION_LESS "14.4")
-        message(WARNING "OS X prior to version 10.10.4 produces incorrect AMD OpenCL code at runtime. You will not be able to use AMD GPUs on this host unless you upgrade your operating system.");
+        message(WARNING "OS X prior to version 10.10.4 produces incorrect AMD OpenCL code at runtime. You will not be able to use AMD GPUs on this host unless you upgrade your operating system.")
 endif()
 
 add_definitions(${OPENCL_DEFINITIONS})
diff -up gromacs-5.1/src/programs/mdrun/tests/moduletest.cpp.opencl gromacs-5.1/src/programs/mdrun/tests/moduletest.cpp
--- gromacs-5.1/src/programs/mdrun/tests/moduletest.cpp.opencl	2015-06-22 15:17:54.000000000 +0200
+++ gromacs-5.1/src/programs/mdrun/tests/moduletest.cpp	2015-09-23 23:01:35.456564790 +0200
@@ -220,7 +220,7 @@ SimulationRunner::callMdrun(const Comman
 #ifdef GMX_MPI
 #  ifdef GMX_GPU
 #    ifdef GMX_THREAD_MPI
-    int         numGpusNeeded = g_numThreads;
+    int         numGpusNeeded = 1;
 #    else   /* Must be real MPI */
     int         numGpusNeeded = gmx_node_num();
 #    endif
